---
layout: post
title: "理解 Git 的返回信息与提交规范"
tags: [Git, 规范]
date: 2025-07-29
comments: true
author: helpfulcraft
---

### 背景

`git add .`, `git commit`, `git push` 是推送项目时常用的高频操作。但每次执行后，终端打印的 `Enumerating objects`, `Delta compression` 等信息代表着什么呢？我以前从未思考过这些问题，只是被工作推着匆匆前进，忽视了背后的逻辑

### 一、`git push` 

一次典型的 `git push` 包含了 Git 在本地准备和与远程仓库交互的完整过程

```bash
> git push
Enumerating objects: 7, done.
Counting objects: 100% (7/7), done.
Delta compression using up to 16 threads
Compressing objects: 100% (4/4), done.
Writing objects: 100% (4/4), 354 bytes | 354.00 KiB/s, done.
Total 4 (delta 3), reused 0 (delta 0), pack-reused 0
remote: Resolving deltas: 100% (3/3), completed with 3 local objects.
To https://github.com/.../blog.git
   a8d5622..f948fb9  main -> main
```

#### 1.1 本地准备阶段
1.  **`Enumerating objects` , `Counting objects`**: Git 在本地**清点**需要推送的对象（objects）。这些对象是 Git 的核心存储单元，包含文件内容、目录结构、提交历史等
 2.  **`Delta compression`**: 这是 Git 的效率核心。它并**不直接传输**修改后的整个文件，而是计算新旧版本之间的**差异（Delta）**，并对差异进行压缩。这被称为**增量压缩 (Delta Compression)**，极大地减少了网络传输的数据量
3.  **`Writing objects`**: 将压缩后的差异数据包**上传**至远程仓库

#### 1.2 远程接收阶段
1.  **`remote: Resolving deltas`**: 来自远程仓库（如 GitHub）的确认消息。表明它已收到差异数据包，并正在基于这些差异**重建**出最新的文件版本
2.  **`Total 4 (delta 3), reused 0`**: 本次推送的总结报告
     *   `Total`: 处理的对象总数
     *   `delta`: 其中有多少是作为差异传输的
     *   `reused`: 远程仓库已存在、无需重复上传的对象数

#### 1.3 核心信息：分支更新摘要
   - `a8d5622..f948fb9`: 表明远程分支的 HEAD 指针，从旧的提交ID (`a8d5622`) 更新到了本次推送的最新提交ID (`f948fb9`)。这个 `..` 范围可以用于精确追溯本次推送包含的所有变更

> **关于 `LF will be replaced by CRLF`**
> 
>  Git 正根据 `.gitattributes` 配置，自动统一不同操作系统（Windows 的 CRLF vs. Linux/macOS 的 LF）的换行符，以保证代码库的一致性

### 二、实践规范：Conventional Commits

`commit -m "fix:时间优化"` 这样的提交，在几天后可能连我自己都难以理解

**Conventional Commits (约定式提交)** 是主流的规范。它提供了一套简单、统一的 `commit message` 格式，旨在让提交历史清晰、可读，并为自动化工具（版本发布、Changelog 生成）提供支持

#### 核心格式
```
<type>(<scope>): <subject>
```
*   **`type` (类型)** [必填]: 说明提交的性质。
    *   `feat`: 新增功能 (feature)
    *   `fix`: 修复 Bug
    *   `docs`: 仅修改文档
    *   `style`: 修改代码格式，不影响逻辑 (如代码格式化)
    *   `refactor`: 代码重构
    *   `perf`: 性能优化
    *   `test`: 新增或修改测试
    *   `chore`: 修改构建流程或辅助工具 (如更新依赖)
    *   `blog`: (我的个人实践) 用于博客文章相关的提交

*   **`scope` (范围)** [选填]: 说明本次提交影响的范围，如模块名、组件名等。

*   **`subject` (主题)** [必填]: 简短描述本次提交的目的。

#### 对比

| 原提交 | 规范化提交 |
| :--- | :--- |
| `fix:总结` | `docs(blog/obsidian): 为知识管理文章添加总结章节` |
| `v2Quartz部署常见问题` | `feat(blog/quartz): 发布V2版Quartz部署指南` |
| `修改了一下` | `style(api): 格式化用户认证相关代码` |
| `fix bug` | `fix(login): 修复密码为空时前端崩溃的问题` |

### 总结
> *   Git `push`等指令的输出是其内部工作流程的透明化展示。理解**增量压缩 (Delta Compression)** 和**分支指针更新**有助于未来更好的使用git优化工作流
> *   编写规范化的 `commit message` 是一种对未来可维护性的投资。**Conventional Commits** 提供了一套行之有效的实践标准